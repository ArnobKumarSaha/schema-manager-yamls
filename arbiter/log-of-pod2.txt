[2022-02-15T08:38:00,031767942+00:00] [replicaset.sh] Bootstrapping MongoDB replica set member: mongodb-2
[2022-02-15T08:38:00,032756258+00:00] [replicaset.sh] Reading standard input...
[2022-02-15T08:38:00,033887953+00:00] [replicaset.sh] Peers: mongodb-0.mongodb-pods.db.svc.cluster.local mongodb-1.mongodb-pods.db.svc.cluster.local

# PING YOURSELF
[2022-02-15T08:38:00,035251366+00:00] [replicaset.sh] Waiting for MongoDB to be ready...
[2022-02-15T08:38:00,036380457+00:00] [replicaset.sh] Running command mongo --ipv6 --host localhost --eval db.adminCommand('ping') . . .
[2022-02-15T08:38:00,093390716+00:00] [replicaset.sh] MongoDB shell version v4.4.6
connecting to: mongodb://localhost:27017/?compressors=disabled&gssapiServiceName=mongodb
Implicit session: session { "id" : UUID("21613b12-0323-48fc-9d99-2a1c58bb80ec") }
MongoDB server version: 4.4.6
{ "ok" : 1 }

# RUN rs.isMaster() to check initialization
[2022-02-15T08:38:00,101499167+00:00] [replicaset.sh] Running command mongo admin --ipv6 --host localhost --quiet --eval JSON.stringify(rs.isMaster()) . . .
[2022-02-15T08:38:00,179425190+00:00] [replicaset.sh] {"topologyVersion":{"processId":{"$oid":"620b6662a3f26889b0116ca6"},"counter":{"$numberLong":"0"}},"ismaster":false,"secondary":false,"info":"Does not have a valid replica set config","isreplicaset":true,"maxBsonObjectSize":16777216,"maxMessageSizeBytes":48000000,"maxWriteBatchSize":100000,"localTime":"2022-02-15T08:38:00.176Z","logicalSessionTimeoutMinutes":30,"connectionId":2,"minWireVersion":0,"maxWireVersion":9,"readOnly":false,"ok":1}
[2022-02-15T08:38:00,182368861+00:00] [replicaset.sh] Running command mongo admin --ipv6 --host mongodb-0.mongodb-pods.db.svc.cluster.local --quiet --eval JSON.stringify(rs.isMaster()) . . .
[2022-02-15T08:38:00,239285737+00:00] [replicaset.sh] {"topologyVersion":{"processId":{"$oid":"620b6632a3860709a0e4187e"},"counter":{"$numberLong":"7"}},"hosts":["mongodb-0.mongodb-pods.db.svc.cluster.local:27017","mongodb-1.mongodb-pods.db.svc.cluster.local:27017"],"setName":"replicaset","setVersion":2,"ismaster":true,"secondary":false,"primary":"mongodb-0.mongodb-pods.db.svc.cluster.local:27017","me":"mongodb-0.mongodb-pods.db.svc.cluster.local:27017","electionId":{"$oid":"7fffffff0000000000000001"},"lastWrite":{"opTime":{"ts":{"$timestamp":{"t":1644914277,"i":1}},"t":{"$numberLong":"1"}},"lastWriteDate":"2022-02-15T08:37:57.000Z","majorityOpTime":{"ts":{"$timestamp":{"t":1644914277,"i":1}},"t":{"$numberLong":"1"}},"majorityWriteDate":"2022-02-15T08:37:57.000Z"},"maxBsonObjectSize":16777216,"maxMessageSizeBytes":48000000,"maxWriteBatchSize":100000,"localTime":"2022-02-15T08:38:00.236Z","logicalSessionTimeoutMinutes":30,"connectionId":119,"minWireVersion":0,"maxWireVersion":9,"readOnly":false,"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":{"t":1644914277,"i":1}},"signature":{"hash":{"$binary":"WBpa7z7J5AoxjCaON8Ya0JtEM24=","$type":"00"},"keyId":{"$numberLong":"7064852852639793156"}}},"operationTime":{"$timestamp":{"t":1644914277,"i":1}}}
[2022-02-15T08:38:00,242214340+00:00] [replicaset.sh] Running command mongo admin --ipv6 --host mongodb-1.mongodb-pods.db.svc.cluster.local --quiet --eval JSON.stringify(rs.isMaster()) . . .
[2022-02-15T08:38:00,279555508+00:00] [replicaset.sh] {"topologyVersion":{"processId":{"$oid":"620b6649afce94a85065d823"},"counter":{"$numberLong":"3"}},"hosts":["mongodb-0.mongodb-pods.db.svc.cluster.local:27017","mongodb-1.mongodb-pods.db.svc.cluster.local:27017"],"setName":"replicaset","setVersion":2,"ismaster":false,"secondary":true,"primary":"mongodb-0.mongodb-pods.db.svc.cluster.local:27017","me":"mongodb-1.mongodb-pods.db.svc.cluster.local:27017","lastWrite":{"opTime":{"ts":{"$timestamp":{"t":1644914277,"i":1}},"t":{"$numberLong":"1"}},"lastWriteDate":"2022-02-15T08:37:57.000Z","majorityOpTime":{"ts":{"$timestamp":{"t":1644914277,"i":1}},"t":{"$numberLong":"1"}},"majorityWriteDate":"2022-02-15T08:37:57.000Z"},"maxBsonObjectSize":16777216,"maxMessageSizeBytes":48000000,"maxWriteBatchSize":100000,"localTime":"2022-02-15T08:38:00.276Z","logicalSessionTimeoutMinutes":30,"connectionId":74,"minWireVersion":0,"maxWireVersion":9,"readOnly":false,"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":{"t":1644914277,"i":1}},"signature":{"hash":{"$binary":"WBpa7z7J5AoxjCaON8Ya0JtEM24=","$type":"00"},"keyId":{"$numberLong":"7064852852639793156"}}},"operationTime":{"$timestamp":{"t":1644914277,"i":1}}}
[2022-02-15T08:38:00,282504068+00:00] [replicaset.sh] Initialized.

< CHECK IF IT IS ALREADY MASTER OR HAS BEEN ALREADY ADDED IN REPLICA SET > using rs.status().myState -> 1 or 2

# RUN rs.isMaster() to find master
[2022-02-15T08:38:05,403228662+00:00] [replicaset.sh] Running command mongo admin --ipv6 --host mongodb-0.mongodb-pods.db.svc.cluster.local -u root -p DQJFM9Fe&1_AyexN --authenticationDatabase admin --quiet --eval JSON.stringify(rs.isMaster()) . . .
[2022-02-15T08:38:05,473208050+00:00] [replicaset.sh] {"topologyVersion":{"processId":{"$oid":"620b6632a3860709a0e4187e"},"counter":{"$numberLong":"7"}},"hosts":["mongodb-0.mongodb-pods.db.svc.cluster.local:27017","mongodb-1.mongodb-pods.db.svc.cluster.local:27017"],"setName":"replicaset","setVersion":2,"ismaster":true,"secondary":false,"primary":"mongodb-0.mongodb-pods.db.svc.cluster.local:27017","me":"mongodb-0.mongodb-pods.db.svc.cluster.local:27017","electionId":{"$oid":"7fffffff0000000000000001"},"lastWrite":{"opTime":{"ts":{"$timestamp":{"t":1644914277,"i":1}},"t":{"$numberLong":"1"}},"lastWriteDate":"2022-02-15T08:37:57.000Z","majorityOpTime":{"ts":{"$timestamp":{"t":1644914277,"i":1}},"t":{"$numberLong":"1"}},"majorityWriteDate":"2022-02-15T08:37:57.000Z"},"maxBsonObjectSize":16777216,"maxMessageSizeBytes":48000000,"maxWriteBatchSize":100000,"localTime":"2022-02-15T08:38:05.470Z","logicalSessionTimeoutMinutes":30,"connectionId":128,"minWireVersion":0,"maxWireVersion":9,"readOnly":false,"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":{"t":1644914277,"i":1}},"signature":{"hash":{"$binary":"WBpa7z7J5AoxjCaON8Ya0JtEM24=","$type":"00"},"keyId":{"$numberLong":"7064852852639793156"}}},"operationTime":{"$timestamp":{"t":1644914277,"i":1}}}
[2022-02-15T08:38:05,524359829+00:00] [replicaset.sh] {"topologyVersion":{"processId":{"$oid":"620b6632a3860709a0e4187e"},"counter":{"$numberLong":"7"}},"hosts":["mongodb-0.mongodb-pods.db.svc.cluster.local:27017","mongodb-1.mongodb-pods.db.svc.cluster.local:27017"],"setName":"replicaset","setVersion":2,"ismaster":true,"secondary":false,"primary":"mongodb-0.mongodb-pods.db.svc.cluster.local:27017","me":"mongodb-0.mongodb-pods.db.svc.cluster.local:27017","electionId":{"$oid":"7fffffff0000000000000001"},"lastWrite":{"opTime":{"ts":{"$timestamp":{"t":1644914277,"i":1}},"t":{"$numberLong":"1"}},"lastWriteDate":"2022-02-15T08:37:57.000Z","majorityOpTime":{"ts":{"$timestamp":{"t":1644914277,"i":1}},"t":{"$numberLong":"1"}},"majorityWriteDate":"2022-02-15T08:37:57.000Z"},"maxBsonObjectSize":16777216,"maxMessageSizeBytes":48000000,"maxWriteBatchSize":100000,"localTime":"2022-02-15T08:38:05.521Z","logicalSessionTimeoutMinutes":30,"connectionId":129,"minWireVersion":0,"maxWireVersion":9,"readOnly":false,"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":{"t":1644914277,"i":1}},"signature":{"hash":{"$binary":"WBpa7z7J5AoxjCaON8Ya0JtEM24=","$type":"00"},"keyId":{"$numberLong":"7064852852639793156"}}},"operationTime":{"$timestamp":{"t":1644914277,"i":1}}}

# rs.Add()
[2022-02-15T08:38:05,526986402+00:00] [replicaset.sh] Found master: mongodb-0.mongodb-pods.db.svc.cluster.local
[2022-02-15T08:38:05,527922287+00:00] [replicaset.sh] Adding myself (mongodb-2.mongodb-pods.db.svc.cluster.local) to replica set...
[2022-02-15T08:38:05,528854766+00:00] [replicaset.sh] Running command mongo admin --ipv6 --host mongodb-0.mongodb-pods.db.svc.cluster.local -u root -p DQJFM9Fe&1_AyexN --authenticationDatabase admin --quiet --eval JSON.stringify(rs.add('mongodb-2.mongodb-pods.db.svc.cluster.local')) . . .
[2022-02-15T08:38:07,646904898+00:00] [replicaset.sh] {"ok":1,"$clusterTime":{"clusterTime":{"$timestamp":{"t":1644914285,"i":1}},"signature":{"hash":{"$binary":"mb/6qh50F+WW+oEp1753iUIglK0=","$type":"00"},"keyId":{"$numberLong":"7064852852639793156"}}},"operationTime":{"$timestamp":{"t":1644914285,"i":1}}}
[2022-02-15T08:38:12,650513453+00:00] [replicaset.sh] Waiting for replica to reach SECONDARY state...
[2022-02-15T08:38:13,797314675+00:00] [replicaset.sh] âœ“ Replica reached SECONDARY state.
[2022-02-15T08:38:13,798346599+00:00] [replicaset.sh] Good bye.